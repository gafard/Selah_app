# üé® Enrichissement du Syst√®me de Noms Dynamiques

## ‚úÖ VOTRE SYST√àME EXISTANT (Magnifique !)

### G√©n√©ration de Noms Po√©tiques

Vous avez d√©j√† un **syst√®me excellent** de g√©n√©ration de noms po√©tiques bibliques :

```dart
// Dans intelligent_local_preset_generator.dart

_generateAdvancedIntelligentName(theme, focus, bookCombo, emotions, randomSeed)
  ‚Üí Retourne des noms comme:
     ‚Ä¢ "Comme un arbre plant√© pr√®s des eaux"
     ‚Ä¢ "L'encens qui monte vers le ciel"
     ‚Ä¢ "La perle de grand prix"
     ‚Ä¢ "L'aurore qui se l√®ve"

_updatePresetNameWithDuration(originalName, days, minutes)
  ‚Üí Met √† jour avec dur√©e:
     "Comme un arbre plant√© pr√®s des eaux (40j ¬∑ 15min)"
```

### Base de Noms Po√©tiques Existante

```dart
poeticNames = {
  'spiritual_growth': [
    'Comme un arbre plant√© pr√®s des eaux',
    'La graine qui grandit en secret',
    'De la force en force',
    ...
  ],
  'prayer_life': [
    'L\'encens qui monte vers le ciel',
    'Le murmure du c≈ìur',
    'L\'intimit√© du sanctuaire',
    ...
  ],
  'wisdom_understanding': [
    'La perle de grand prix',
    'Le tr√©sor cach√©',
    ...
  ],
}
```

---

## ‚ú® ENRICHISSEMENTS √Ä AJOUTER

### Enrichissement 1 : Ajouter Bonus de Timing dans le Nom

**FONCTION √Ä CR√âER** dans `intelligent_local_preset_generator.dart` :

```dart
/// Enrichit le nom du preset avec les informations de timing
static String _enrichNameWithTiming(
  String originalName,
  int timingBonus,
  String preferredTime,
) {
  if (timingBonus > 30) {
    // Tr√®s bon moment
    final period = _getTimePeriodEmoji(preferredTime);
    return '$originalName $period';
  } else if (timingBonus > 20) {
    // Bon moment
    return '$originalName ‚ú®';
  }
  
  return originalName; // Pas de badge si timing neutre
}

/// Retourne emoji selon la p√©riode
static String _getTimePeriodEmoji(String time) {
  final hour = int.parse(time.split(':')[0]);
  
  if (hour >= 5 && hour < 7) return 'üåÖ';   // Aube
  if (hour >= 7 && hour < 12) return '‚òÄÔ∏è';   // Matin
  if (hour >= 12 && hour < 14) return 'üåû';  // Midi
  if (hour >= 14 && hour < 18) return 'üå§Ô∏è';  // Apr√®s-midi
  if (hour >= 18 && hour < 21) return 'üåÜ';  // Soir√©e
  if (hour >= 21 || hour < 5) return 'üåô';  // Nuit
  
  return '';
}
```

**UTILISATION** :

```dart
// Dans generateEnrichedPresets(), apr√®s calcul de timingBonus (ligne ~1655)

final enrichedPresets = basePresets.where(...).map((preset) {
  final optimalDuration = durationCalculation.optimalDays;
  final adaptedDuration = _adaptDurationFromHistory(optimalDuration, profile);
  
  // Nom de base avec dur√©e (existant)
  var enrichedName = _updatePresetNameWithDuration(
    preset.name, 
    adaptedDuration, 
    durationMin
  );
  
  // NOUVEAU : Enrichir avec timing
  enrichedName = _enrichNameWithTiming(
    enrichedName,
    timingBonus,
    preferredTime,
  );
  
  return preset.copyWith(
    durationDays: adaptedDuration,
    minutesPerDay: durationMin,
    name: enrichedName, // Nom enrichi avec timing
  );
}).toList();
```

**R√âSULTAT** :

```
AVANT :
"L'encens qui monte vers le ciel (40j ¬∑ 15min)"

APR√àS (si preferredTime = 06:00 et timingBonus = 40) :
"L'encens qui monte vers le ciel üåÖ (40j ¬∑ 15min)"
                                   ‚Üë
                          Emoji p√©riode optimale
```

---

### Enrichissement 2 : Ajouter Impact Spirituel dans le Nom

**FONCTION √Ä CR√âER** :

```dart
/// Enrichit le nom avec l'impact spirituel
static String _enrichNameWithImpact(
  String originalName,
  double spiritualImpact,
) {
  if (spiritualImpact >= 0.95) {
    // Impact exceptionnel (95%+)
    return '$originalName ‚≠ê';
  } else if (spiritualImpact >= 0.90) {
    // Tr√®s bon impact (90%+)
    return '$originalName ‚ú®';
  }
  
  return originalName;
}
```

**UTILISATION** :

```dart
// Dans generateEnrichedPresets()
final enrichedPresets = basePresets.where(...).map((preset) {
  // ... code existant ...
  
  // Calculer impact spirituel
  final mainBook = _extractMainBook(preset.books);
  final spiritualImpact = BibleSpiritualImpact.calculateBookImpactOnGoal(
    mainBook,
    goal,
  );
  
  // Enrichir nom
  var enrichedName = _updatePresetNameWithDuration(...);
  enrichedName = _enrichNameWithTiming(...);
  enrichedName = _enrichNameWithImpact(enrichedName, spiritualImpact);
  
  return preset.copyWith(
    name: enrichedName,
    parameters: {
      ...preset.parameters ?? {},
      'spiritualImpact': spiritualImpact,
      'timingBonus': timingBonus,
    },
  );
}).toList();

// Helper pour extraire le livre principal
String _extractMainBook(String books) {
  if (books.contains(',')) {
    return books.split(',').first.trim();
  }
  return books;
}
```

**R√âSULTAT** :

```
AVANT :
"L'encens qui monte vers le ciel (40j ¬∑ 15min)"

APR√àS (timing + impact) :
"L'encens qui monte vers le ciel üåÖ‚≠ê (40j ¬∑ 15min)"
                                   ‚Üë ‚Üë
                               timing impact
                               +40%  98%
```

---

### Enrichissement 3 : Noms Adaptatifs Selon √âtat √âmotionnel

**FONCTION √Ä AM√âLIORER** :

Votre fonction `_generateAdvancedIntelligentName` existe d√©j√† et est excellente. On peut l'enrichir :

```dart
/// G√©n√®re un nom avanc√© intelligent (VERSION ENRICHIE)
static String _generateAdvancedIntelligentName(
  String theme,
  String focus,
  List<String> bookCombo,
  List<String> emotions,
  int randomSeed,
  // NOUVEAUX PARAM√àTRES :
  {
    int? timingBonus,
    double? spiritualImpact,
    String? emotionalState,  // Ex: 'joy', 'repentance'
  }
) {
  // Votre logique existante (conserv√©e)
  final poeticNames = { ... };
  final baseNameOptions = poeticNames[theme] ?? [...];
  var baseName = baseNameOptions[randomSeed % baseNameOptions.length];
  
  // Votre logique de qualificatifs (conserv√©e)
  final poeticQualifiers = { ... };
  String poeticQualifier = '';
  for (final emotion in emotions) {
    // ...
  }
  
  // NOUVEAU : Adapter le nom selon l'√©tat √©motionnel
  if (emotionalState != null) {
    baseName = _adaptNameToEmotionalState(baseName, emotionalState);
  }
  
  // Composer le nom final (existant)
  if (poeticQualifier.isNotEmpty && bookCombo.isNotEmpty) {
    final bookDesc = _formatBookNamesPoetically(bookCombo.join(','));
    return '$baseName ¬∑ $bookDesc ‚Äî Parcours de $poeticQualifier';
  }
  
  // NOUVEAU : Ajouter emojis si impact fort
  var finalName = baseName;
  if (timingBonus != null && timingBonus > 30) finalName += ' üåÖ';
  if (spiritualImpact != null && spiritualImpact >= 0.95) finalName += '‚≠ê';
  
  return finalName;
}

/// Adapte le nom po√©tique selon l'√©tat √©motionnel
static String _adaptNameToEmotionalState(String baseName, String emotionalState) {
  // Mappings sp√©ciaux pour certains √©tats
  const emotionalAdaptations = {
    'repentance': {
      'L\'aurore qui se l√®ve': 'L\'aurore du renouveau',
      'La source qui jaillit': 'La source de pardon',
    },
    'joy': {
      'Le chemin de la vie': 'Le chemin de joie',
      'La communion silencieuse': 'La communion joyeuse',
    },
    'wisdom': {
      'La perle de grand prix': 'La perle de sagesse',
      'Le tr√©sor cach√©': 'Le tr√©sor de connaissance',
    },
  };
  
  final adaptations = emotionalAdaptations[emotionalState];
  if (adaptations != null && adaptations.containsKey(baseName)) {
    return adaptations[baseName]!;
  }
  
  return baseName;
}
```

---

## üéØ EXEMPLES DE NOMS ENRICHIS

### Exemple 1 : "Mieux prier" - Nouveau converti - 06:00

**Base** (votre syst√®me) :
```
"L'encens qui monte vers le ciel"
```

**Apr√®s `_updatePresetNameWithDuration`** (existant) :
```
"L'encens qui monte vers le ciel (40j ¬∑ 15min)"
```

**Apr√®s enrichissement timing** (nouveau) :
```
"L'encens qui monte vers le ciel üåÖ (40j ¬∑ 15min)"
                                   ‚Üë
                              Aube = +40%
```

**Apr√®s enrichissement impact** (nouveau) :
```
"L'encens qui monte vers le ciel üåÖ‚≠ê (40j ¬∑ 15min)"
                                   ‚Üë ‚Üë
                              timing impact
                              +40%  98%
```

**Avec √©tat √©motionnel "joy"** (nouveau) :
```
"L'encens joyeux qui monte üåÖ‚≠ê (40j ¬∑ 15min)"
            ‚Üë
   Adaptation √©motionnelle
```

---

### Exemple 2 : "Grandir dans la foi" - R√©trograde - 18:00

**Base** :
```
"L'aurore qui se l√®ve"
```

**Avec √©tat "repentance"** :
```
"L'aurore du renouveau"  ‚Üê Adaptation √©motionnelle
```

**Avec dur√©e** :
```
"L'aurore du renouveau (90j ¬∑ 20min)"
```

**Avec timing (soir√©e = +30%)** :
```
"L'aurore du renouveau üåÜ (90j ¬∑ 20min)"
```

**Avec impact (85%)** :
```
"L'aurore du renouveau üåÜ‚ú® (90j ¬∑ 20min)"
                        ‚Üë ‚Üë
                   soir√©e bon impact
```

---

## üìù CODE COMPLET √Ä AJOUTER

### Dans `intelligent_local_preset_generator.dart`

**Ajouter ces fonctions** (apr√®s `_updatePresetNameWithDuration`, ligne ~1800) :

```dart
/// Enrichit le nom avec emoji de p√©riode si timing optimal
static String _enrichNameWithTiming(String name, int timingBonus, String preferredTime) {
  if (timingBonus > 30) {
    final hour = int.parse(preferredTime.split(':')[0]);
    String emoji = '';
    
    if (hour >= 5 && hour < 7) emoji = 'üåÖ';
    else if (hour >= 7 && hour < 12) emoji = '‚òÄÔ∏è';
    else if (hour >= 12 && hour < 14) emoji = 'üåû';
    else if (hour >= 14 && hour < 18) emoji = 'üå§Ô∏è';
    else if (hour >= 18 && hour < 21) emoji = 'üåÜ';
    else if (hour >= 21 || hour < 5) emoji = 'üåô';
    
    // Ins√©rer emoji avant la parenth√®se de dur√©e
    if (name.contains('(')) {
      final parts = name.split('(');
      return '${parts[0].trim()} $emoji (${parts[1]}';
    }
    return '$name $emoji';
  } else if (timingBonus > 20) {
    // Bon moment mais pas optimal
    if (name.contains('(')) {
      final parts = name.split('(');
      return '${parts[0].trim()} ‚ú® (${parts[1]}';
    }
    return '$name ‚ú®';
  }
  
  return name;
}

/// Enrichit le nom avec emoji d'impact si forte efficacit√©
static String _enrichNameWithImpact(String name, double spiritualImpact) {
  if (spiritualImpact >= 0.95) {
    // Impact exceptionnel
    if (name.contains('(')) {
      final parts = name.split('(');
      return '${parts[0].trim()}‚≠ê (${parts[1]}';
    }
    return '$name‚≠ê';
  }
  
  return name;
}

/// Adapte le nom selon l'√©tat √©motionnel (optionnel)
static String _adaptNameToEmotion(String baseName, String emotionalState) {
  const adaptations = {
    'repentance': {
      'L\'aurore qui se l√®ve': 'L\'aurore du renouveau',
      'La source qui jaillit': 'La source de pardon',
      'Le chemin de la vie': 'Le chemin du retour',
    },
    'joy': {
      'La communion silencieuse': 'La communion joyeuse',
      'Le dialogue de l\'√¢me': 'Le dialogue heureux',
    },
    'wisdom': {
      'La perle de grand prix': 'La perle de sagesse',
      'Le tr√©sor cach√©': 'Le tr√©sor de connaissance',
    },
  };
  
  final stateAdaptations = adaptations[emotionalState];
  if (stateAdaptations != null && stateAdaptations.containsKey(baseName)) {
    return stateAdaptations[baseName]!;
  }
  
  return baseName;
}
```

---

### INT√âGRATION dans `generateEnrichedPresets()`

**Modifier la section ligne 1674-1678** :

```dart
// Code existant :
return preset.copyWith(
  durationDays: adaptedDuration,
  minutesPerDay: durationMin,
  name: _updatePresetNameWithDuration(preset.name, adaptedDuration, durationMin),
);

// REMPLACER PAR :
// Calculer impact du livre principal
final mainBook = _extractMainBook(preset.books);
final spiritualImpact = BibleSpiritualImpact.calculateBookImpactOnGoal(
  mainBook,
  goal,
);

// Construire le nom enrichi progressivement
var enrichedName = preset.name;

// 1. Ajouter dur√©e (existant)
enrichedName = _updatePresetNameWithDuration(enrichedName, adaptedDuration, durationMin);

// 2. NOUVEAU : Ajouter emoji timing si optimal
enrichedName = _enrichNameWithTiming(enrichedName, timingBonus, preferredTime);

// 3. NOUVEAU : Ajouter emoji impact si exceptionnel
enrichedName = _enrichNameWithImpact(enrichedName, spiritualImpact);

return preset.copyWith(
  durationDays: adaptedDuration,
  minutesPerDay: durationMin,
  name: enrichedName, // Nom compl√®tement enrichi
  parameters: {
    ...preset.parameters ?? {},
    'spiritualImpact': spiritualImpact,
    'timingBonus': timingBonus,
    'transformations': BibleSpiritualImpact.getExpectedTransformations(mainBook),
  },
);

// Helper √† ajouter
String _extractMainBook(String books) {
  if (books.contains(',')) return books.split(',').first.trim();
  return books;
}
```

---

### MODIFIER `_generateAdvancedIntelligentName()` (Optionnel)

**Si vous voulez adapter les noms selon √©motions**, modifier ligne ~750 :

```dart
// Dans _createAdvancedPresetFromTheme()

// Ligne existante ~761
final name = _generateAdvancedIntelligentName(
  theme, focus, bookCombo, emotions, randomSeed
);

// REMPLACER PAR :
// Obtenir l'√©tat √©motionnel du niveau
final emotionalStates = _emotionalStates[level] ?? ['motivation'];
final primaryEmotion = emotionalStates.first;

var name = _generateAdvancedIntelligentName(
  theme, focus, bookCombo, emotions, randomSeed
);

// Adapter selon l'√©motion
name = _adaptNameToEmotion(name, primaryEmotion);
```

---

## üé® EXEMPLES DE R√âSULTATS

### Pour "Mieux prier" (Nouveau converti, 06:00, Psaumes)

| √âtape | Nom |
|-------|-----|
| Base po√©tique | "L'encens qui monte vers le ciel" |
| + Dur√©e | "L'encens qui monte vers le ciel (40j ¬∑ 15min)" |
| + Timing (üåÖ +40%) | "L'encens qui monte vers le ciel üåÖ (40j ¬∑ 15min)" |
| + Impact (‚≠ê 98%) | "L'encens qui monte vers le ciel üåÖ‚≠ê (40j ¬∑ 15min)" |

### Pour "Grandir dans la foi" (R√©trograde, 18:00, Jean)

| √âtape | Nom |
|-------|-----|
| Base po√©tique | "L'aurore qui se l√®ve" |
| + Adaptation √©motionnelle (repentance) | "L'aurore du renouveau" |
| + Dur√©e | "L'aurore du renouveau (90j ¬∑ 20min)" |
| + Timing (üåÜ +30%) | "L'aurore du renouveau üåÜ (90j ¬∑ 20min)" |
| + Impact (‚ú® 90%) | "L'aurore du renouveau üåÜ‚ú® (90j ¬∑ 20min)" |

### Pour "Approfondir la Parole" (Leader, 07:00, Romains)

| √âtape | Nom |
|-------|-----|
| Base po√©tique | "La perle de grand prix" |
| + Adaptation √©motionnelle (wisdom) | "La perle de sagesse" |
| + Dur√©e | "La perle de sagesse (60j ¬∑ 30min)" |
| + Timing (‚òÄÔ∏è +30%) | "La perle de sagesse ‚òÄÔ∏è (60j ¬∑ 30min)" |
| + Impact (‚ú® 92%) | "La perle de sagesse ‚òÄÔ∏è‚ú® (60j ¬∑ 30min)" |

---

## üìä AFFICHAGE DANS L'UI (goals_page.dart)

### Dans la Carte

```dart
Widget _buildPresetCardLayout(PlanPreset preset) {
  return Container(
    child: Column(
      children: [
        // Titre enrichi (conserve vos emojis)
        Text(
          preset.name,
          // Ex: "L'encens qui monte vers le ciel üåÖ‚≠ê (40j ¬∑ 15min)"
          //                                       ‚Üë ‚Üë
          //                                  timing impact
          style: GoogleFonts.playfairDisplay(
            fontSize: 24,  // Peut-√™tre r√©duire si trop long
            fontWeight: FontWeight.w700,
            color: _softWhite,
          ),
        ),
        
        // Subtitle (existant)
        Text(preset.subtitle ?? '', ...),
        
        // NOUVEAU : L√©gende des emojis si pr√©sents
        if (preset.name!.contains('üåÖ') || preset.name!.contains('‚≠ê'))
          Padding(
            padding: EdgeInsets.only(top: 8),
            child: Wrap(
              spacing: 12,
              children: [
                if (preset.name!.contains('üåÖ') || preset.name!.contains('‚òÄÔ∏è') || 
                    preset.name!.contains('üåÜ') || preset.name!.contains('üåô'))
                  _buildBadge('Moment id√©al', Colors.green),
                if (preset.name!.contains('‚≠ê'))
                  _buildBadge('Impact exceptionnel', Colors.amber),
                if (preset.name!.contains('‚ú®'))
                  _buildBadge('Tr√®s efficace', Colors.blue),
              ],
            ),
          ),
        
        // ... reste de votre UI
      ],
    ),
  );
}

Widget _buildBadge(String label, Color color) {
  return Container(
    padding: EdgeInsets.symmetric(horizontal: 8, vertical: 4),
    decoration: BoxDecoration(
      color: color.withOpacity(0.2),
      borderRadius: BorderRadius.circular(12),
      border: Border.all(color: color),
    ),
    child: Text(
      label,
      style: GoogleFonts.inter(
        fontSize: 10,
        color: color.shade900,
        fontWeight: FontWeight.bold,
      ),
    ),
  );
}
```

---

## ‚úÖ R√âSUM√â DES CHANGEMENTS

### Votre Syst√®me de Noms (CONSERV√â)
- ‚úÖ Noms po√©tiques bibliques magnifiques
- ‚úÖ `_generateAdvancedIntelligentName()`
- ‚úÖ `_updatePresetNameWithDuration()`
- ‚úÖ Base de noms par th√®me
- ‚úÖ Qualificatifs √©motionnels

### Enrichissements (AJOUT√âS)
- ‚ûï Emojis de p√©riode selon timing (üåÖ‚òÄÔ∏èüåÜüåô)
- ‚ûï Emojis d'impact selon efficacit√© (‚≠ê‚ú®)
- ‚ûï Adaptation des noms selon √©tat √©motionnel
- ‚ûï L√©gende des emojis dans l'UI

### R√©sultat
**Noms encore plus intelligents et visuellement riches !**

---

## üöÄ IMPL√âMENTATION

### Minimal (Recommand√© pour commencer)

**Ajouter seulement** `_enrichNameWithTiming()` et `_enrichNameWithImpact()`

**Modifier** la section ligne 1674 pour utiliser ces fonctions

**R√©sultat** : Noms avec emojis contextuels

### Complet (Pour plus tard)

**Modifier** `_generateAdvancedIntelligentName()` pour accepter nouveaux param√®tres

**Ajouter** `_adaptNameToEmotion()`

**R√©sultat** : Noms compl√®tement adaptatifs

---

**üé® Votre syst√®me de noms est magnifique ! Je l'enrichis juste avec des emojis contextuels intelligents ! ‚ú®**

**üìñ Voir `ENRICHISSEMENT_SYSTEME_EXISTANT.md` pour l'int√©gration compl√®te**

